<!DOCTYPE html>
<html>
  <!--wmartinmimi/md.html-->
  <!--MIT Licensed https://github.com/wmartinmimi/md.html/blob/main/LICENSE-->

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />


    <script>
      function addJS(url) {
        let js = document.createElement("script");
        js.src = url;
        js.onload = function() {
          readyjs += 1;
          if (readyjs >= totaljs) {
            readyToRun = true;
            console.log("ready")
            main();
          }
        };
        document.head.appendChild(js);
      }

      function addCSS(url) {
        let link = document.createElement("link");
        link.href = url;
        link.rel = "stylesheet"
        document.head.appendChild(link);
      }

      readyjs = 0;
      totaljs = 5;
      readyToRun = false;

      async function heading() {

        let response = await fetch('app.json');
        let json = await response.json();
        console.log(json);
        for (url of json.imports) {
          console.log(url)
          let seg = url.split(".");
          let extension = seg[seg.length - 1];
          if (extension === "js") {
            addJS(url);
            // totaljs += 1;
          } else if (extension === "css") {
            addCSS(url);
          }
        }
      }
      heading();
    </script>
  </head>

  <body>
    <section id="popup-overlay"></section>
    <div class="popup-container">
      <div class="popup">
        <span id="exit-popup">X</span>
        <h3>Save File</h3>
        <div class="buttons-container">
          <button id="save-md" onclick="downloadFile('markdown')">
            Markdown
          </button>
          <button id="save-html" onclick="downloadFile('html')">HTML</button>
          <button id="save-both" onclick="downloadFile('both')">Both</button>
        </div>
      </div>
    </div>
    <div id="markdown"></div>
    <script>

      async function body() {
        let response = await fetch('app.json');
        let json = await response.json();

        addJS(json.main);
      }

      body();


    </script>
  </body>

</html>