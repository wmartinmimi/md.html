<!DOCTYPE html>
<html>

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--jquery-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>

    <!--drawdown | markdown rendering-->
    <script src="drawdown.js"></script>

    <!--katex | latex rendering-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>

    <style>
      * {
        --hr-color: #cccccc;
        --quote-line-color: #d3daea;
        --code-color: #d3daea40;
        --row-2n-color: #f3f3f3;
        --table-color: #aaaaaa;
        --main-bg-color: #ffffff;
        --link-color: #1671dc;
        --inline-code-color: #eff1f3;
        color: #24292f;
      }

      @media (prefers-color-scheme: dark) {
        * {
          --hr-color: #30363d;
          --quote-line-color: #30363d;
          --code-color: #161b22;
          --row-2n-color: #161b22;
          --table-color: #aaaaaa;
          --main-bg-color: #0d1117;
          --inline-code-color: #343941;
          color: #c9d1d9;
        }
      }

      body {
        background-color: var(--main-bg-color);
      }

      a {
        color: var(--link-color);
        text-decoration: none;
      }

      a:hover {
        text-decoration-line: underline;
      }

      hr {
        margin: 1em 0;
        border: 0;
        border-bottom: 3pt solid var(--hr-color);
      }

      blockquote {
        margin-left: 0;
        padding: 0.5em 0 0.5em 2em;
        border-left: 3px solid var(--quote-line-color);
      }

      li,
      code {
        margin: 0.4em 0;
      }

      p {
        margin: 0.9em 0;
      }

      code {
        background-color: var(--inline-code-color);
        padding: 3pt;
        padding-left: 5pt;
        padding-right: 5pt;
        border-radius: 5pt;
      }

      pre>code {
        display: block;
        padding: 1em;
        background: var(--code-color);
      }

      table {
        border-spacing: 0;
        border-collapse: collapse;
      }

      td {
        padding: 4px 8px;
      }

      tr:nth-child(2n) {
        background-color: var(--row-2n-color);
      }

      th {
        border-bottom: 1px solid var(--table-color);
      }

      #markdown {
        margin: 0;
        padding: 0.5em;
        overflow: auto;
        font-family: Segoe UI, Helvetica, Arial, sans-serif;
        font-size: 1em;
        line-height: 1.3;
      }
    </style>
  </head>

  <body>
    <div id="markdown"></div>
    <script>
      // namespace issue
      parser = markdown

      async function getText(path) {
        response = await fetch(path);
        text = response.text();

        return text
      }

      function checkPath(path) {
        // Make sure it points to a markdown file 
        let ismd = path.endsWith(".md") || path.endsWith(".markdown")
        if (!ismd) { return null }

        return path
      }

      async function getMd() {
        // Get markdown element
        const markdown = document.querySelector('#markdown');

        // Gets URL parameters 
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);

        let path = null;

        // Get URL path parameter 
        if (urlParams.has('path')) {
          path = checkPath(urlParams.get('path'));
        }

        // Check if path is valid 
        console.log(path);
        if (path === null) {
          markdown.innerHTML = parser(await getText('README.md'));
        } else {
          markdown.innerHTML = parser(await getText(path));
        }
        renderMathInElement(document.body)
      }

      getMd();

    </script>
  </body>

</html>